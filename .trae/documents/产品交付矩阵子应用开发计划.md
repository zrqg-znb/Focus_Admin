# 产品交付矩阵 (Product Delivery Matrix) 开发计划

根据您的需求，我制定了以下开发计划，涵盖后端模型设计、API 开发以及前端管理端和展示端的实现。

## 1. 后端架构设计 (Backend)

将在 `backend-django/apps/` 下新建 `delivery_matrix` 应用。

### 1.1 数据模型 (`models.py`)

我们将建立三层层级结构，并关联现有的 `Project` 模型。

* **DeliveryDomain (交付领域)**

  * `name`: 领域名称 (如：车控、座舱)

  * `code`: 唯一标识

  * `interface_people`: ManyToMany -> `core.User` (领域接口人)

* **ProjectGroup (项目群)**

  * `name`: 项目群名称

  * `domain`: ForeignKey -> `DeliveryDomain`

  * `managers`: ManyToMany -> `core.User` (项目群经理)

* **ProjectComponent (项目组件)**

  * `name`: 组件名称

  * `group`: ForeignKey -> `ProjectGroup`

  * `linked_project`: ForeignKey -> `project_manager.Project` (关联的项目，可为空)

  * `managers`: ManyToMany -> `core.User` (项目经理)

### 1.2 核心逻辑 (`services.py` & `schemas.py`)

* **Schema**: 定义 Pydantic 模型，用于数据校验和序列化。`ProjectComponentOut` 将包含关联项目的里程碑信息 (Milestone QG dates)。

* **Service**:

  * 实现基础 CRUD 逻辑。

  * 实现 `get_matrix_dashboard_data` 方法，聚合“领域 -> 群 -> 组件 -> 项目里程碑”的嵌套数据结构，供展示页使用。

### 1.3 API 接口 (`api.py`)

* `/admin/domains`, `/admin/groups`, `/admin/components`: 管理端 CRUD 接口。

* `/dashboard/matrix`: 聚合数据接口，返回树状结构数据。

### 1.4 注册路由

* 在 `apps/router.py` 中注册 `delivery_matrix` 的路由。

## 2. 前端架构设计 (Frontend)

将在前端项目 `views/` 目录下新建 `delivery-matrix` 模块。

### 2.1 目录结构

```text
views/delivery-matrix/
├── data.ts              # API 定义与类型接口
├── admin/               # 管理后台页面
│   ├── index.vue        # 入口 (使用 Tabs 切换不同维度的管理)
│   ├── DomainTable.vue  # 领域管理表格
│   ├── GroupTable.vue   # 项目群管理表格
│   └── ComponentTable.vue # 组件管理表格
└── dashboard/           # 对外展示页面
    └── index.vue        # 矩阵展示视图
```

### 2.2 页面功能

* **管理后台 (`admin/index.vue`)**:

  * 使用 `VxeTable` 实现数据的增删改查。

  * 支持关联 `Project` 的选择（下拉搜索）。

  * 支持多选人员（接口人、经理）。

* **展示看板 (`dashboard/index.vue`)**:

  * 自定义布局，按“领域”分块展示。

  * 直观展示层级关系及关联项目的里程碑进度。

## 3. 执行步骤

1. **创建后端 App**: 生成目录与文件，编写 Model 代码。
2. **编写 Schema 与 Service**: 实现业务逻辑与数据转换。
3. **编写 API**: 暴露接口并注册路由。
4. **前端开发**: 编写 `data.ts` 定义 API，随后实现管理页与展示页。

请确认此架构与计划是否符合您的预期？确认后我将开始编写代码。
